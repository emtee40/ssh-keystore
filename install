#!/usr/bin/env sh
# ColtonDRG's SSH Keystore
# Script to install keys to a system.

$AUTHORIZED_KEYS_LOCATION="$HOME/.ssh/authorized_keys"

if ( "$1" != "" ); then
	$AUTHORIZED_KEYS_LOCATION="$1"
fi

cd `dirname $0`
echo "The ssh keys from commit `git rev-parse HEAD` will be installed."
echo "The keys will be installed to $AUTHORIZED_KEYS_LOCATION"
echo "If the commit is wrong, use `git pull` to update the repo."
echo "If the installation location is wrong, use \`./install <authorized_keys>\`."
echo "Also note that the contents of $AUTHORIZED_KEYS_LOCATION will be destroyed."
echo "If these are correct, press [Enter]. Press [Ctrl+C] to cancel."
read
echo "" > $AUTHORIZED_KEYS_LOCATION
echo "# Generated by ColtonDRG/ssh-keystore/install" >> $AUTHORIZED_KEYS_LOCATION
echo "# Generated from ColtonDRG/ssh-keystore commit `git rev-parse HEAD` on `date -u +%Y/%m/%d at %H:%M`" >> $AUTHORIZED_KEYS_LOCATION
echo "# Pull the latest changes and re-run ./install to update." >> $AUTHORIZED_KEYS_LOCATION
cat *.pub >> $AUTHORIZED_KEYS_LOCATION
