#!/usr/bin/env sh
# ColtonDRG's SSH Keystore
# Script to install keys to a system.

INSTALL_FILE=$HOME/.ssh/authorized_keys

if [ "$1" != "" ]; then
	INSTALL_FILE=`readlink -f $1`
fi

cd `dirname $0`
echo "The ssh keys from commit `git rev-parse --short HEAD` will be installed."
echo "The keys will be installed to $INSTALL_FILE"
echo "If the commit is wrong, use \`git pull\` to update the repo."
echo "If the installation location is wrong, use \`./install <authorized_keys>\`."
echo "Also note that the contents of $INSTALL_FILE will be destroyed."
echo "If these are correct, press [Enter]. Press [Ctrl+C] to cancel."
read
echo "# Generated by ColtonDRG/ssh-keystore/install" > $INSTALL_FILE
echo "# Generated from ColtonDRG/ssh-keystore commit `git rev-parse --short HEAD` on `date -u "+%Y/%m/%d %H:%M"`" >> $INSTALL_FILE
echo "# Pull the latest changes and re-run the install script to update." >> $INSTALL_FILE
echo "" >> $INSTALL_FILE
cat *.pub >> $INSTALL_FILE
